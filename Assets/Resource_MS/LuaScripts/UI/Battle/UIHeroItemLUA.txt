---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by liuyubao.
--- DateTime: 2022/1/18 11:29
---
---具体item lua 对象 与 ScrollViewBaseItem 一一对应
---@class UIHeroItemLUA:UIDragMoveBaseItem
local UIHeroItemLUA = SimpleClassUtil:class(UIDragMoveBaseItem)

function UIHeroItemLUA:initialize(transform,layer)
    UIDragMoveBaseItem.initialize(self,transform)
    self._transform = transform
    self._layer = layer
    self._index = -1
    self._isUpTeam = false
    self:initComponent(transform)
end

function UIHeroItemLUA:initComponent(transform)
    --self._indexText =  transform:Find("index"):GetComponent("Text")
    --self._btSelf = transform:GetComponent("Button")
    --self._btSelf.onClick:AddListener(function ()
    --    self:onBtSelf()
    --end)
    self._img_bg =  transform:Find("m_img_bg"):GetComponent("Image")
    self._img_icon =  transform:Find("m_img_icon"):GetComponent("Image")
    self._img_frame =  transform:Find("m_img_frame"):GetComponent("Image")
    self._img_tl_frame =  transform:Find("m_img_tl_frame"):GetComponent("Image")
    self._img_tl_icon =  transform:Find("m_img_tl_icon"):GetComponent("Image")
    self._img_tr =  transform:Find("m_img_tr"):GetComponent("Image")
    self._img_star =  transform:Find("m_img_star"):GetComponent("Image")
    self._go_level =  transform:Find("m_img_level").gameObject
    self._tmptxt_level =  transform:Find("m_img_level/m_tmptxt_level"):GetComponent("TMPro.TextMeshProUGUI")
    self._go_upTeam = transform:Find("m_img_up_team").gameObject
end

function UIHeroItemLUA:setData(index,data,stateParams)
    self._index = index
    self._data = data
    self._stateParams = stateParams
    self:setBaseData(data)
    self:setStatusData(stateParams)
    --Logger.ErrorTable(data)
end
------------------------------------------------------------
function UIHeroItemLUA:setBaseData(data)
   self:setIcon(data.heroId)
   self:setBg(data.quality)
   self:setFrame(data.quality)
   --self:setStar(data.star)
   self:setLevel(data.level)
end

function UIHeroItemLUA:setIcon(heroId)
    self._layer:SetSprite(self._img_icon,UIUtils:getHeroIconByHeroId(heroId))
end

function UIHeroItemLUA:setBg(quality)
    self._layer:SetSprite(self._img_bg,UIUtils:getHeroBg(quality))
end

function UIHeroItemLUA:setFrame(quality)
    self._layer:SetSprite(self._img_frame,UIUtils:getHeroFrame(quality))
end

function UIHeroItemLUA:setLevel(level)
    self._tmptxt_level.text = level
end

-----------------------------------------------

function UIHeroItemLUA:setStatusData(stateParams)
   self:setUpTeam(stateParams.isUpTeam)
end

function UIHeroItemLUA:setUpTeam(isUpTeam)
  self._stateParams.isUpTeam = isUpTeam
    self._go_upTeam:SetActiveVirtual(isUpTeam)
end

---------------------------------------------------
function UIHeroItemLUA:onBtSelf()

end
-----------------------------------------------------
---
function UIHeroItemLUA:setDelegate(star, ing, endDrag, click,onPress)
    self._startDrag = star
    self._ingDrag = ing
    self._endDrag = endDrag
    self._click = click
    self._onPress = onPress
end

function UIHeroItemLUA:isCanDrag()
    return not self._stateParams.isUpTeam
end

function UIHeroItemLUA:onClick(obj)
    self:clickEvent()
end


function UIHeroItemLUA:clickEvent()
    if self._click then
        self._click(self._data,self._stateParams.isUpTeam)
    end
end

function UIHeroItemLUA:beginEvent(eventData)
    --self._mediator:setStartDrag(self._hero:getId())
    if self._startDrag then
        self._startDrag(self._data)
    end
end

function UIHeroItemLUA:ingEvent(eventData,vec,isSlant)
    if isSlant then
        --self._mediator:setDragPosition(vec,self._hero:getId())
        if self._ingDrag then
            self._ingDrag(self._data)
        end
    end
end

function UIHeroItemLUA:endEvent(eventData,isSlant)
    --self._mediator:setEndDrag(self._hero:getId())
    if self._endDrag then
        self._endDrag(isSlant)
    end
end

function UIHeroItemLUA:slantDragAngle()
    return 80
end

return UIHeroItemLUA