---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by lyb.
--- DateTime: 2022/1/6 23:17
---@class ISystem
local ISystem = SimpleClassUtil:class()
function ISystem:initialize()
    ---@type BattleRenderCharacter []
    self._entityMap = {}

    self._eventListenerList = {}

    self:registerMsg()
end

function ISystem:getEventHandleMap()
    --return {
    --    [EventType.Event_Battle_Render_SwitchAni] = "switchAniHandle",
    --}
    Logger.error("overwrite me ！！！")
    return {}
end

---@param Entity BattleRenderCharacter
function ISystem:addEntity(Entity)
    if Entity then
        if self._entityMap[Entity:getUid()] then
            Logger.error("重复添加 Entity :  ",Entity:getUid())
            return
        end
        self._entityMap[Entity:getUid()] = Entity
    end
end
---@param Entity BattleRenderCharacter
function ISystem:removeEntity(Entity)
    if Entity then
        if self._entityMap[Entity:getUid()] == nil then
            Logger.error("Entity 已经从删除 :  ",Entity:getUid())
            return
        end
        self._entityMap[Entity:getUid()] = nil
    end
end
---@return BattleRenderCharacter
function ISystem:getEntityByUid(uid)
    return self._entityMap[uid]
end


function ISystem:registerMsg()
    local eventHandleMap = self:getEventHandleMap()
    for i, v in pairs(eventHandleMap) do
        if i and v and self[v] then
            self._eventListenerList[i] = EventManager:AddListener(i,self[v],self)
        end
    end
end

function ISystem:unRegisterMsg()
    for i, v in pairs(self._eventListenerList) do
        if i and v  then
            EventManager:RemoveListener(i,v)
        end
    end
end

function ISystem:release()
    self:unRegisterMsg()
end

return ISystem