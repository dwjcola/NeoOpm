---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by lyb.
--- DateTime: 2021/12/8 0:03
--- 技能是固定timeline
---@class bt_ac_playTimeLine : IAction
local bt_ac_playTimeLine = SimpleClassUtil:class(IAction)

function bt_ac_playTimeLine:initData(data)
    ---@type  SkillData
    self._skillData = data.skillData
    self._timeLineInfo = data.timeLineInfo
    self._frameCount = 0
end
---@param blackBoard BlackBoard_BattleBase
function bt_ac_playTimeLine:doAction(blackBoard,agent)
    local result = Enum_BT.Node_ResultType.Fail
    if self._frameCount >  self._skillData._endFrame then
        self._frameCount = 0
        result = Enum_BT.Node_ResultType.Success
    else
        if self._frameCount == 0 then
            local frameDataList =  self._timeLineInfo[-1] or {}
            if frameDataList then
                BattleLogicEventHandle:handleSkillFrameInfo(blackBoard,agent,frameDataList,self._frameCount,self._skillData._skillTag)
            end
        end
        self._frameCount = self._frameCount + 1
        local frameDataList = self._timeLineInfo[self._frameCount]
        if frameDataList then
            BattleLogicEventHandle:handleSkillFrameInfo(blackBoard,agent,frameDataList,self._frameCount,self._skillData._skillTag)
        end
        result = Enum_BT.Node_ResultType.Running
    end
    return result
end

return bt_ac_playTimeLine