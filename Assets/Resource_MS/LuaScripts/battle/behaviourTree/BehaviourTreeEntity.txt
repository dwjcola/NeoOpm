---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by liuyubao.
--- DateTime: 2021/12/9 15:03
--- 行为树黑板
---@class BehaviourTreeEntity:MiddleClass
local BehaviourTreeEntity = SimpleClassUtil:class()

function BehaviourTreeEntity:initialize(treeData,blackboard,contextManager)
   ---@type Blackboard
   self._blackboard = blackboard

   ---@type NodeBase
   self._rootNode = self:initTree(treeData,blackboard,contextManager)

   self._contextManager = contextManager
end

function BehaviourTreeEntity:initTree(treeData,blackboard,agent)
    self._rootNode = BehaviourAnalysis:Analysis(treeData,blackboard,agent)
    if self._rootNode == nil then
        Logger.Error("行为树 初始化失败")
    end
end

function BehaviourTreeEntity:getBlackBoard()
    return self._blackboard
end

function BehaviourTreeEntity:getRootNode()
    return self._rootNode
end

function BehaviourTreeEntity:execute()
    if self._rootNode then
        self._rootNode:prePosition()
        local  resultType = self._rootNode:execute()
        self._rootNode:postPosition(resultType)
    end
end

function BehaviourTreeEntity:clear()
    if self._rootNode then
        self._rootNode:postPosition(Enum_BT.Node_ResultType.Fail)
    end
end
return BehaviourTreeEntity