---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by lyb.
--- DateTime: 2021/12/8 0:03
--- 条件节点(叶节点)
--local NodeLeaf = require_path("NodeLeaf","battle/behaviourTree/Nodes/AbstractNode/NodeLeaf")
---@class NodeConditionGroup : NodeLeaf
local NodeConditionGroup = SimpleClassUtil:class(NodeLeaf)

function NodeConditionGroup:initialize()
    NodeLeaf.initialize(self,Enum_BT.Node_Type.ConditionGroup)

    ---有 condition 方法得 表 就认为是 ICondition
     ---@type ICondition[] 因为lua 无法定义 接口 所以带
    self._iConditionList = { }
    self._list_parameterList = {}
    self._list_conditionGroup = {}
    --self:setICondition(self)
end
---@param type Enum_BT.Condition_Relation
function NodeConditionGroup:setIConditionS(iConditionList,type)
    self._iConditionList = iConditionList
    self._relationType = type
end

function NodeConditionGroup:execute(blackBoard,agent,dt)
    self:log_enter("NodeConditionGroup    Entity: ",self:getEntityId())
    local resultType = Enum_BT.Node_ResultType.Fail
    if self._iConditionList  then
        if self._relationType == Enum_BT.Condition_Relation.BT_AND then
            resultType =  Enum_BT.Node_ResultType.Success
            for i, v in ipairs(self._iConditionList) do
                if v:doCondition(blackBoard,agent,dt) == Enum_BT.Node_ResultType.Fail  then
                    resultType =  Enum_BT.Node_ResultType.Fail
                    break
                end
            end
        else
            resultType =  Enum_BT.Node_ResultType.Fail
            for i, v in ipairs(self._iConditionList) do
                if  v:doCondition(blackBoard,agent,dt) == Enum_BT.Node_ResultType.Success then
                    resultType =  Enum_BT.Node_ResultType.Success
                    break
                end
            end
        end
    else
        resultType =  Enum_BT.Node_ResultType.Fail
    end
    self:log("NodeConditionGroup   Entity: ",self:getEntityId(),    "  resultType :", resultType)
    return resultType
end

return NodeConditionGroup