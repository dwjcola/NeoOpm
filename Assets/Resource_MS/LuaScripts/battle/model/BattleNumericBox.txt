--- 数值盒子
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by liuyubao.
--- DateTime: 2022/2/21 18:01
---@class BattleNumericBox
local BattleNumericBox = SimpleClassUtil:class()

function BattleNumericBox:initialize(uid,attributeList)
    self._uid = uid
    ---@type BattleAttribute[]
    self._map_attribute = {}
    self:initAttribute(attributeList)
end

function BattleNumericBox:initAttribute(attributeList)
    attributeList = attributeList or {}
    for id, v in pairs(attributeList) do
       self:setValue(id,v)
    end
end

function BattleNumericBox:setValue(key,value)
    local oldValue = 0
    if  self._map_attribute[key] == nil then
        self._map_attribute[key] = BattleAttribute:new(key,value)
    else
        oldValue = self._map_attribute[key]:get()
        self._map_attribute[key]:set(value)
    end
    EventManager:Dispatch_battle(EventType.Event_Battle_NumericBox_ValueChange, { attributeId = key ,newValue = value,oldValue = oldValue})
end

function BattleNumericBox:getValue(key)
    if  self._map_attribute[key] then
        return  self._map_attribute[key]:get()
    else
        return 0
    end
end

function BattleNumericBox:reset()
    for i, attribute in pairs(self._map_attribute) do
        if attribute and attribute.reset then
            attribute:reset()
        end
    end
end

return BattleNumericBox